# Migration `20200624165827-start`

This migration has been generated by Jawad HASSANI at 6/24/2020, 4:58:27 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "prisma"."Cat" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"elo" integer  NOT NULL DEFAULT 1000,"id" SERIAL,"image" text  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "prisma"."Vote" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"loserId" integer  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,"winnerId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "prisma"."Post" DROP CONSTRAINT IF EXiSTS "Post_authorId_fkey";

ALTER TABLE "prisma"."Vote" ADD FOREIGN KEY ("winnerId")REFERENCES "prisma"."Cat"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "prisma"."Vote" ADD FOREIGN KEY ("loserId")REFERENCES "prisma"."Cat"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "prisma"."Post";

DROP TABLE "prisma"."User";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200624165827-start
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,33 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+generator typegraphql {
+  provider = "node node_modules/typegraphql-prisma/generator.js"
+  output   = "../prisma/generated/type-graphql"
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+model Cat {
+  id        Int       @id @default(autoincrement())
+  image     String
+  elo       Int       @default(1000)
+  wins      Vote[]    @relation("WinVotes")
+  loses     Vote[]    @relation("LoseVotes")
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+}
+
+model Vote {
+  id       Int @id @default(autoincrement())
+  winner   Cat @relation(name: "WinVotes", fields: [winnerId], references: [id])
+  winnerId Int
+  loser    Cat @relation(name: "LoseVotes", fields: [loserId], references: [id])
+  loserId  Int
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
```


